{
    "malware_investigation": {
        "description": "Profile optimized for malware incidents, focusing on memory, processes, network activity, and persistence mechanisms.",
        "memory_acquisition": {
            "enabled": true,
            "method": "auto",
            "compress": true,
            "verify_acquisition": true,
            "acquire_pagefile": true
        },
        "volatile_data": {
            "enabled": true,
            "categories": [
                "processes",
                "network",
                "services",
                "modules",
                "startup_items",
                "scheduled_tasks",
                "command_history",
                "system_info",
                "loaded_dlls",
                "registry_autorun"
            ],
            "process_arguments": true,
            "process_environment": false,
            "process_handles": true,
            "process_memory_strings": true
        },
        "network_state": {
            "enabled": true,
            "connections": "all",
            "routing_table": true,
            "arp_cache": true,
            "dns_cache": true,
            "interfaces": true,
            "packet_capture": {
                "enabled": true,
                "max_packets": 10000,
                "max_size_mb": 200,
                "filter": "not port 22 and not port 3389",
                "capture_duration_seconds": 300
            }
        },
        "custom_commands": [
            "find /tmp -type f -mmin -60 -ls",
            "find /var/tmp -type f -mmin -60 -ls",
            "find /dev/shm -type f -ls",
            "find /home -name '.*' -type f -mtime -7 -ls",
            "grep -l 'HttpBrowser|NanoCore|Meterpreter|Cobalt' /var/log/auth.log*"
        ]
    },
    "data_breach": {
        "description": "Profile for suspected data breaches, focusing on network connections, file system access, user activity, and potentially relevant processes.",
        "memory_acquisition": {
            "enabled": false,
            "method": "auto",
            "compress": true,
            "verify_acquisition": true,
            "acquire_pagefile": false
        },
        "volatile_data": {
            "enabled": true,
            "categories": [
                "processes",
                "network",
                "users",
                "command_history",
                "open_files",
                "system_info",
                "file_access_history",
                "login_history",
                "network_shares"
            ],
            "process_arguments": true,
            "process_environment": false,
            "file_access_monitoring": true
        },
        "network_state": {
            "enabled": true,
            "connections": "all",
            "routing_table": true,
            "arp_cache": true,
            "dns_cache": true,
            "interfaces": true,
            "packet_capture": {
                "enabled": true,
                "max_packets": 25000,
                "max_size_mb": 500,
                "filter": "tcp or udp and port not 22",
                "capture_duration_seconds": 600,
                "focus_outbound": true
            }
        },
        "custom_commands": [
            "lsof -nPi",
            "auditctl -l",
            "find /home -type f -name '*.zip' -o -name '*.tar.*' -o -name '*.7z' -mtime -7 -ls",
            "find /tmp -type f -mtime -2 -size +1M -ls",
            "grep -i 'transfer\\|download\\|upload\\|copy' ~/.bash_history",
            "grep -i 'access\\|denied\\|unauthorized' /var/log/auth.log* | tail -n 500",
            "who -a"
        ]
    },
    "unauthorized_access": {
        "description": "Profile for investigating unauthorized access, focusing on user sessions, login history, command execution, and network activity.",
        "memory_acquisition": {
            "enabled": false,
            "method": "auto",
            "compress": true,
            "verify_acquisition": false
        },
        "volatile_data": {
            "enabled": true,
            "categories": [
                "users",
                "processes",
                "network",
                "command_history",
                "scheduled_tasks",
                "login_history",
                "system_info",
                "sudo_history",
                "ssh_config",
                "auth_config",
                "user_accounts"
            ],
            "process_arguments": true,
            "process_environment": false,
            "collect_bash_histories": true,
            "collect_auth_logs": true
        },
        "network_state": {
            "enabled": true,
            "connections": "all",
            "routing_table": true,
            "arp_cache": true,
            "dns_cache": true,
            "interfaces": true,
            "packet_capture": {
                "enabled": false
            }
        },
        "custom_commands": [
            "last -F",
            "w",
            "lastlog",
            "cat ~/.bash_history",
            "find /home -name .ssh -type d -exec ls -la {} \\;",
            "grep -i 'session opened\\|session closed\\|failed password\\|authentication failure' /var/log/auth.log*",
            "find / -perm -4000 -type f -ls 2>/dev/null",
            "find /etc -mtime -7 -type f -ls",
            "ausearch -m user_login -ts today",
            "getent passwd | grep -v nologin | grep -v false"
        ]
    },
    "quick_triage": {
        "description": "Minimal profile for rapid initial assessment of system state.",
        "memory_acquisition": {
            "enabled": false
        },
        "volatile_data": {
            "enabled": true,
            "categories": [
                "processes",
                "network",
                "users",
                "system_info",
                "login_history"
            ],
            "process_arguments": true,
            "process_environment": false,
            "minimal_collection": true
        },
        "network_state": {
            "enabled": true,
            "connections": "listening",
            "routing_table": false,
            "arp_cache": false,
            "dns_cache": false,
            "interfaces": true,
            "packet_capture": {
                "enabled": false
            }
        },
        "custom_commands": [
            "w",
            "uname -a",
            "ps auxf | head -30",
            "netstat -tulpn | grep LISTEN",
            "ss -tulpn | grep LISTEN",
            "last | head -20"
        ]
    },
    "full_collection": {
        "description": "Comprehensive profile capturing maximum volatile data. Use with caution due to potential system impact and large evidence size.",
        "memory_acquisition": {
            "enabled": true,
            "method": "auto",
            "compress": true,
            "verify_acquisition": true,
            "acquire_pagefile": true,
            "acquire_hibernation_file": true
        },
        "volatile_data": {
            "enabled": true,
            "categories": [
                "processes",
                "network",
                "users",
                "services",
                "modules",
                "startup_items",
                "scheduled_tasks",
                "command_history",
                "login_history",
                "open_files",
                "system_info",
                "environment_variables",
                "loaded_dlls",
                "registry_autorun",
                "file_access_history",
                "network_shares",
                "sudo_history",
                "ssh_config",
                "auth_config",
                "user_accounts",
                "usb_history",
                "network_usage"
            ],
            "process_arguments": true,
            "process_environment": true,
            "process_handles": true,
            "process_memory_strings": true,
            "collect_bash_histories": true,
            "collect_auth_logs": true,
            "file_access_monitoring": true,
            "preserve_timestamp_metadata": true
        },
        "network_state": {
            "enabled": true,
            "connections": "all",
            "routing_table": true,
            "arp_cache": true,
            "dns_cache": true,
            "interfaces": true,
            "packet_capture": {
                "enabled": true,
                "max_packets": 50000,
                "max_size_mb": 1000,
                "filter": "",
                "capture_duration_seconds": 900,
                "focus_outbound": true
            }
        },
        "custom_commands": [
            "ps auxef",
            "lsof -nPi",
            "netstat -peanut",
            "ss -tulpna",
            "ip route show",
            "ip neigh show",
            "last -Fai",
            "w",
            "cat /etc/passwd",
            "cat /etc/shadow",
            "cat /etc/group",
            "lsmod",
            "systemctl list-units --type=service",
            "crontab -l",
            "find /etc/rc*.d /etc/systemd/system -type l",
            "find /home -name '.*history' -type f -exec ls -la {} \\;",
            "find / -perm -4000 -type f -ls 2>/dev/null",
            "find / -perm -2000 -type f -ls 2>/dev/null",
            "find /var/log -mtime -7 -type f -exec ls -la {} \\;",
            "find /dev -type c -o -type b | sort",
            "find /tmp /var/tmp /dev/shm -type f -exec ls -la {} \\;",
            "grep -i 'session\\|login\\|auth\\|sudo\\|su\\|root' /var/log/auth.log* | tail -n 1000",
            "grep -i 'failed\\|invalid\\|error' /var/log/auth.log* | tail -n 1000",
            "ausearch -m user_login -ts today",
            "ausearch -m user_cmd -ts today",
            "getent passwd | sort",
            "dpkg -l || rpm -qa",
            "grep -r '^[^#]' /etc/cron*",
            "journalctl -b -p warning,err,crit,alert,emerg --no-pager"
        ]
    },
    "ransomware_incident": {
        "description": "Profile for suspected ransomware incidents, focusing on file encryption activities, persistence, and common ransomware indicators.",
        "memory_acquisition": {
            "enabled": true,
            "method": "auto",
            "compress": true,
            "verify_acquisition": true,
            "acquire_pagefile": true
        },
        "volatile_data": {
            "enabled": true,
            "categories": [
                "processes",
                "network",
                "services",
                "modules",
                "startup_items",
                "scheduled_tasks",
                "command_history",
                "system_info",
                "open_files",
                "file_access_history",
                "registry_autorun"
            ],
            "process_arguments": true,
            "process_environment": true,
            "process_handles": true,
            "minimal_collection": false
        },
        "network_state": {
            "enabled": true,
            "connections": "all",
            "routing_table": true,
            "arp_cache": true,
            "dns_cache": true,
            "interfaces": true,
            "packet_capture": {
                "enabled": true,
                "max_packets": 15000,
                "max_size_mb": 300,
                "filter": "",
                "capture_duration_seconds": 300
            }
        },
        "custom_commands": [
            "find / -name \"*.locked\" -o -name \"*ransom*\" -o -name \"*decrypt*\" -o -name \"README*txt\" -o -name \"*.encrypt\" -type f -mtime -2 2>/dev/null",
            "grep -ri \"ransom\\|bitcoin\\|pay\\|decrypt\" /home /root /tmp /var/tmp --include=\"*.txt\" 2>/dev/null",
            "find /home -type f -name \"*.jpg\" -o -name \"*.png\" -o -name \"*.txt\" -o -name \"*.html\" -mtime -2 | grep -i 'ransom\\|decrypt\\|bitcoin\\|payment'",
            "ps aux | grep -i 'crypt\\|ransom\\|enc'",
            "lsof | grep -i 'delete'",
            "find /home -type f -name \"*.zip\" -o -name \"*.7z\" -o -name \"*.tar.*\" -o -name \"*.rar\" -o -name \"*.gpg\" -mtime -2",
            "find / -type f -perm 777 -mtime -2",
            "cat /var/log/syslog | grep -i 'denied\\|error\\|failed\\|crypto\\|permission'",
            "find / -name \"*.sh\" -type f -mtime -2 -perm /111"
        ]
    }
}
